import * as fs from 'fs';
import * as readline from 'readline';

const bookMap = {
  "GEN": "سِفْرُ ٱلتَّكْوِين",
  "EXO": "سِفْرُ ٱلْخُرُوج",
  "LEV": "سِفْرُ ٱللَّاوِيِّين",
  "NUM": "سِفْرُ ٱلْعَدَد",
  "DEU": "سِفْرُ ٱلتَّثْنِيَة",
  "JOS": "سِفْرُ يَشُوع",
  "JDG": "سِفْرُ ٱلْقُضَاة",
  "RUT": "سِفْرُ رَاعُوث",
  "1SA": "سِفْرُ صَمُوئِيل ٱلْأَوَّل",
  "2SA": "سِفْرُ صَمُوئِيل ٱلثَّانِي",
  "1KI": "سِفْرُ ٱلْمُلُوك ٱلْأَوَّل",
  "2KI": "سِفْرُ ٱلْمُلُوك ٱلثَّانِي",
  "1CH": "سِفْرُ أَخْبَارِ ٱلْأَيَّام ٱلْأَوَّل",
  "2CH": "سِفْرُ أَخْبَارِ ٱلْأَيَّام ٱلثَّانِي",
  "EZR": "سِفْرُ عَزْرَا",
  "NEH": "سِفْرُ نَحَمْيَا",
  "EST": "سِفْرُ أَسْتِير",
  "JOB": "سِفْرُ أَيُّوب",
  "PSA": "سِفْرُ ٱلْمَزَامِير",
  "PRO": "سِفْرُ ٱلْأَمْثَال",
  "ECC": "سِفْرُ ٱلْجَامِعَة",
  "SOL": "سِفْرُ ٱلنَّشِيد ٱلْأَنْشَاد",
  "ISA": "سِفْرُ إِشَعْيَاء",
  "JER": "سِفْرُ إِرْمِيَا",
  "LAM": "سِفْرُ ٱلْمَرَاثِي",
  "EZE": "سِفْرُ حِزْقِيَال",
  "DAN": "سِفْرُ دَانِيَال",
  "HOS": "سِفْرُ هُوشَع",
  "JOE": "سِفْرُ يُوئِيل",
  "AMO": "سِفْرُ عَامُوس",
  "OBA": "سِفْرُ عُوبَدْيَا",
  "JON": "سِفْرُ يُونَان",
  "MIC": "سِفْرُ مِيخَا",
  "NAH": "سِفْرُ نَاحُوم",
  "HAB": "سِفْرُ حَبَقُّوق",
  "ZEP": "سِفْرُ صَفَنْيَا",
  "HAG": "سِفْرُ حَجَّي",
  "ZEC": "سِفْرُ زَكَرِيَّا",
  "MAL": "سِفْرُ مَلَاخِي",
  "MAT": "إِنْجِيل مَتَّى",
  "MAR": "إِنْجِيل مَرْقُس",
  "LUK": "إِنْجِيل لُوقَا",
  "JOH": "إِنْجِيل يُوحَنَّا",
  "ACT": "سِفْرُ أَعْمَالِ ٱلرُّسُل",
  "ROM": "رِسَالَة رُومِيَة",
  "1CO": "رِسَالَة كُورِنْثُوس ٱلْأُولَى",
  "2CO": "رِسَالَة كُورِنْثُوس ٱلثَّانِيَة",
  "GAL": "رِسَالَة غَلَاطِيَّة",
  "EPH": "رِسَالَة أَفَسُس",
  "PHI": "رِسَالَة فِيلِبِّي",
  "COL": "رِسَالَة كُولُوسِّي",
  "1TH": "رِسَالَة تَسَالُونِيكِي ٱلْأُولَى",
  "2TH": "رِسَالَة تَسَالُونِيكِي ٱلثَّانِيَة",
  "1TI": "رِسَالَة تِيمُوثَاوُس ٱلْأُولَى",
  "2TI": "رِسَالَة تِيمُوثَاوُس ٱلثَّانِيَة",
  "TIT": "رِسَالَة تِيطُس",
  "PHM": "رِسَالَة فِيلِيمُون",
  "HEB": "رِسَالَة ٱلْعِبْرَانِيِّين",
  "JAM": "رِسَالَة يَعْقُوب",
  "1PE": "رِسَالَة بُطْرُس ٱلْأُولَى",
  "2PE": "رِسَالَة بُطْرُس ٱلثَّانِيَة",
  "1JO": "رِسَالَة يُوحَنَّا ٱلْأُولَى",
  "2JO": "رِسَالَة يُوحَنَّا ٱلثَّانِيَة",
  "3JO": "رِسَالَة يُوحَنَّا ٱلثَّالِثَة",
  "JUD": "رِسَالَة يَهُوذَا",
  "REV": "سِفْرُ ٱلرُّؤْيَا"
};

const chapterNumber = {
  "1": "الإِصْحَاحُ الأَوَّلُ",
  "2": "الإِصْحَاحُ الثَّانِي",
  "3": "الإِصْحَاحُ الثَّالِثُ",
  "4": "الإِصْحَاحُ الرَّابِعُ",
  "5": "الإِصْحَاحُ الْخَامِسُ",
  "6": "الإِصْحَاحُ السَّادِسُ",
  "7": "الإِصْحَاحُ السَّابِعُ",
  "8": "الإِصْحَاحُ الثَّامِنُ",
  "9": "الإِصْحَاحُ التَّاسِعُ",
  "10": "الإِصْحَاحُ الْعَاشِرُ",
  "11": "الإِصْحَاحُ الْحَادِي عَشَرَ",
  "12": "الإِصْحَاحُ الثَّانِي عَشَرَ",
  "13": "الإِصْحَاحُ الثَّالِثُ عَشَرَ",
  "14": "الإِصْحَاحُ الرَّابِعُ عَشَرَ",
  "15": "الإِصْحَاحُ الْخَامِسُ عَشَرَ",
  "16": "الإِصْحَاحُ السَّادِسُ عَشَرَ",
  "17": "الإِصْحَاحُ السَّابِعُ عَشَرَ",
  "18": "الإِصْحَاحُ الثَّامِنُ عَشَرَ",
  "19": "الإِصْحَاحُ التَّاسِعُ عَشَرَ",
  "20": "الإِصْحَاحُ العِشْرُونَ",
  "21": "الإِصْحَاحُ الحَادِي وَالعِشْرُونَ",
  "22": "الإِصْحَاحُ الثَّانِي وَالعِشْرُونَ",
  "23": "الإِصْحَاحُ الثَّالِثُ وَالعِشْرُونَ",
  "24": "الإِصْحَاحُ الرَّابِعُ وَالعِشْرُونَ",
  "25": "الإِصْحَاحُ الْخَامِسُ وَالعِشْرُونَ",
  "26": "الإِصْحَاحُ السَّادِسُ وَالعِشْرُونَ",
  "27": "الإِصْحَاحُ السَّابِعُ وَالعِشْرُونَ",
  "28": "الإِصْحَاحُ الثَّامِنُ وَالعِشْرُونَ",
  "29": "الإِصْحَاحُ التَّاسِعُ وَالعِشْرُونَ",
  "30": "الإِصْحَاحُ الثَّلاثُونَ",
  "31": "الإِصْحَاحُ الحَادِي وَالثَّلاَثُونَ",
  "32": "الإِصْحَاحُ الثَّانِي وَالثَّلاَثُونَ",
  "33": "الإِصْحَاحُ الثَّالِثُ وَالثَّلاَثُونَ",
  "34": "الإِصْحَاحُ الرَّابِعُ وَالثَّلاَثُونَ",
  "35": "الإِصْحَاحُ الْخَامِسُ وَالثَّلاَثُونَ",
  "36": "الإِصْحَاحُ السَّادِسُ وَالثَّلاَثُونَ",
  "37": "الإِصْحَاحُ السَّابِعُ وَالثَّلاَثُونَ",
  "38": "الإِصْحَاحُ الثَّامِنُ وَالثَّلاَثُونَ",
  "39": "الإِصْحَاحُ التَّاسِعُ وَالثَّلاَثُونَ",
  "40": "الإِصْحَاحُ الأَرْبَعُونَ",
  "41": "الإِصْحَاحُ الحَادِي وَالأَرْبَعُونَ",
  "42": "الإِصْحَاحُ الثَّانِي وَالأَرْبَعُونَ",
  "43": "الإِصْحَاحُ الثَّالِثُ وَالأَرْبَعُونَ",
  "44": "الإِصْحَاحُ الرَّابِعُ وَالأَرْبَعُونَ",
  "45": "الإِصْحَاحُ الْخَامِسُ وَالأَرْبَعُونَ",
  "46": "الإِصْحَاحُ السَّادِسُ وَالأَرْبَعُونَ",
  "47": "الإِصْحَاحُ السَّابِعُ وَالأَرْبَعُونَ",
  "48": "الإِصْحَاحُ الثَّامِنُ وَالأَرْبَعُونَ",
  "49": "الإِصْحَاحُ التَّاسِعُ وَالأَرْبَعُونَ",
  "50": "الإِصْحَاحُ الخَمْسُونَ",
  "51": "الإِصْحَاحُ الحَادِي وَالخَمْسُونَ",
  "52": "الإِصْحَاحُ الثَّانِي وَالخَمْسُونَ",
  "53": "الإِصْحَاحُ الثَّالِثُ وَالخَمْسُونَ",
  "54": "الإِصْحَاحُ الرَّابِعُ وَالخَمْسُونَ",
  "55": "الإِصْحَاحُ الْخَامِسُ وَالخَمْسُونَ",
  "56": "الإِصْحَاحُ السَّادِسُ وَالخَمْسُونَ",
  "57": "الإِصْحَاحُ السَّابِعُ وَالخَمْسُونَ",
  "58": "الإِصْحَاحُ الثَّامِنُ وَالخَمْسُونَ",
  "59": "الإِصْحَاحُ التَّاسِعُ وَالخَمْسُونَ",
  "60": "الإِصْحَاحُ السِّتُّونَ",
  "61": "الإِصْحَاحُ الحَادِي وَالسِّتُّونَ",
  "62": "الإِصْحَاحُ الثَّانِي وَالسِّتُّونَ",
  "63": "الإِصْحَاحُ الثَّالِثُ وَالسِّتُّونَ",
  "64": "الإِصْحَاحُ الرَّابِعُ وَالسِّتُّونَ",
  "65": "الإِصْحَاحُ الْخَامِسُ وَالسِّتُّونَ",
  "66": "الإِصْحَاحُ السَّادِسُ وَالسِّتُّونَ",
  "67": "الإِصْحَاحُ السَّابِعُ وَالسِّتُّونَ",
  "68": "الإِصْحَاحُ الثَّامِنُ وَالسِّتُّونَ",
  "69": "الإِصْحَاحُ التَّاسِعُ وَالسِّتُّونَ",
  "70": "الإِصْحَاحُ السَّبْعُونَ",
  "71": "الإِصْحَاحُ الحَادِي وَالسَّبْعُونَ",
  "72": "الإِصْحَاحُ الثَّانِي وَالسَّبْعُونَ",
  "73": "الإِصْحَاحُ الثَّالِثُ وَالسَّبْعُونَ",
  "74": "الإِصْحَاحُ الرَّابِعُ وَالسَّبْعُونَ",
  "75": "الإِصْحَاحُ الْخَامِسُ وَالسَّبْعُونَ",
  "76": "الإِصْحَاحُ السَّادِسُ وَالسَّبْعُونَ",
  "77": "الإِصْحَاحُ السَّابِعُ وَالسَّبْعُونَ",
  "78": "الإِصْحَاحُ الثَّامِنُ وَالسَّبْعُونَ",
  "79": "الإِصْحَاحُ التَّاسِعُ وَالسَّبْعُونَ",
  "80": "الإِصْحَاحُ الثَّمانُونَ",
  "81": "الإِصْحَاحُ الحَادِي وَالثَّمانُونَ",
  "82": "الإِصْحَاحُ الثَّانِي وَالثَّمانُونَ",
  "83": "الإِصْحَاحُ الثَّالِثُ وَالثَّمانُونَ",
  "84": "الإِصْحَاحُ الرَّابِعُ وَالثَّمانُونَ",
  "85": "الإِصْحَاحُ الْخَامِسُ وَالثَّمانُونَ",
  "86": "الإِصْحَاحُ السَّادِسُ وَالثَّمانُونَ",
  "87": "الإِصْحَاحُ السَّابِعُ وَالثَّمانُونَ",
  "88": "الإِصْحَاحُ الثَّامِنُ وَالثَّمانُونَ",
  "89": "الإِصْحَاحُ التَّاسِعُ وَالثَّمانُونَ",
  "90": "الإِصْحَاحُ التِّسْعُونَ",
  "91": "الإِصْحَاحُ الحَادِي وَالتِّسْعُونَ",
  "92": "الإِصْحَاحُ الثَّانِي وَالتِّسْعُونَ",
  "93": "الإِصْحَاحُ الثَّالِثُ وَالتِّسْعُونَ",
  "94": "الإِصْحَاحُ الرَّابِعُ وَالتِّسْعُونَ",
  "95": "الإِصْحَاحُ الْخَامِسُ وَالتِّسْعُونَ",
  "96": "الإِصْحَاحُ السَّادِسُ وَالتِّسْعُونَ",
  "97": "الإِصْحَاحُ السَّابِعُ وَالتِّسْعُونَ",
  "98": "الإِصْحَاحُ الثَّامِنُ وَالتِّسْعُونَ",
  "99": "الإِصْحَاحُ التَّاسِعُ وَالتِّسْعُونَ",  
}


// Input and output file paths
const inputFilePath = '../Bible_Ar_SVD_1865.VPL.txt';
const outputFilePath = 'output.txt';

// Create read and write streams
const readStream = fs.createReadStream(inputFilePath, 'utf8');
const writeStream = fs.createWriteStream(outputFilePath, 'utf8');

const rl = readline.createInterface({
  input: readStream,
  crlfDelay: Infinity,
});

let lastChapter = '';

rl.on('line', (line) => {
  const match = line.match(/^(\d?[A-Z]+)\s+(\d+):\d+\s+(.+)$/);

  if (match) {
    const [_, book, chapter, verse] = match;
    const currentChapter = `${bookMap[book]}, الإِصْحَاحُ ${chapter}`;

    // Write chapter heading if it's a new chapter
    if (currentChapter !== lastChapter) {
      if (lastChapter) writeStream.write('\n'); // Extra space between chapters
      writeStream.write(`${currentChapter}\n`);
      lastChapter = currentChapter;
    }

    // Write just the verse content
    writeStream.write(`${verse}\n`);
  } else {
    // Log unmatched lines for debugging
    console.log('Unmatched line:', line);
  }
});

rl.on('close', () => {
  writeStream.end();
  console.log('File processed and saved as:', outputFilePath);
});
